# 🚨 主任者講習アプリ - 問題品質レビュー依頼

**日時**: 2025-10-21 03:12:16 UTC
**対象**: 1200問の自動生成問題
**重要度**: 🔴 **CRITICAL**

---

## 📊 チェック結果サマリー

| 指標 | 結果 |
|-----|------|
| **総問題数** | 1,200 |
| **重大エラー率** | 100% (1,200/1,200) |
| **平均品質スコア** | 81.25/100 |
| **健全な問題** | 0問 |
| **主なエラー種別** | 文法エラー（単語重複）|

---

## 🔴 エラーの詳細分析

### エラーパターン

**すべての問題で検出: 単語重複**

| エラーパターン | 件数 | 例 |
|-------------|------|-----|
| 単語重複 + "のについて" | 全 | "営業許可営業許可のについて法定の規制がある" |
| "のは～が" 文法エラー | 全 | "照度基準照度基準のは～が必須である" |
| プレースホルダー残存 | 一部 | "～" が残存 |

### カテゴリ別エラー率

```
営業許可・申請手続き:  100% (172/172)
建物・設備基準:       100% (172/172)
従業員・管理者要件:   100% (172/172)
営業時間・休業:       100% (171/171)
景品・景慮基準:       100% (171/171)
法律・規制違反:       100% (171/171)
実務・業務管理:       100% (171/171)
```

---

## 🔍 初期分析（Worker3）

### 推定原因

1. **RAG生成テンプレート問題**
   - テンプレート: `{subject}{subject}の...`
   - 「{subject}」が重複・置換されていない可能性

2. **LLM生成プロンプトの問題**
   - プロンプト設計の欠陥
   - トークンの予約文字列（`～`）が残存

3. **データソース処理の問題**
   - 風営法PDF抽出テキストの前処理不足
   - テンプレート変数が未置換のままJSONに保存

### RAG/生成ロジック

生成スクリプト場所:
- `/home/planj/patshinko-exam-app/backend/rag-bulk-problem-generator.js`
- `/home/planj/patshinko-exam-app/backend/rag-pipeline.js`
- `/home/planj/patshinko-exam-app/backend/advanced-problem-generator.js`

---

## ❓ レビュー依頼事項

### Worker2 へ（テスト・品質検証観点）

1. **運転免許試験の生成ロジックと比較**
   - 運転免許試験では、このようなテンプレート重複エラーは発生したか？
   - 正誤問題の標準的な生成プロセスを教えてください

2. **問題の適正性の判断基準**
   - このエラー率（100%）は修正可能か？
   - 修正にかかる工数の見積もり

3. **テスト計画への影響**
   - 現在の1200問でテストを続行すべきか？
   - または、修正後の問題で再テストすべきか？

### GPT-5 へ（改善提案）

1. **RAGパイプライン改善**
   - 現在のプロンプトを見直し、改善案を提案
   - テンプレート変数の確実な置換方法

2. **LLM生成プロンプトの最適化**
   - 文法エラー排除、プレースホルダー確認
   - 品質チェック機能の組み込み

3. **自動修正ツール**
   - 既存の1200問を自動修正できるか？
   - スクリプト実装の方針

---

## 📁 関連ファイル

| ファイル | 説明 |
|--------|------|
| `/tmp/quality_check_report.json` | 詳細レポート（JSON） |
| `/tmp/quality_review_request.json` | レビュー要請データ |
| `/home/planj/patshinko-exam-app/backend/problem-quality-checker.js` | チェッカー実装 |
| `/home/planj/patshinko-exam-app/public/mock_problems.json` | 対象ファイル（1200問） |

---

## 🎯 次のステップ

1. ✅ **チェック完了** ← 現在地点
2. ⏳ **Worker2 レビュー** ← 待機中
3. ⏳ **GPT-5 改善提案** ← 待機中
4. 🔄 **修正実装**
5. 🧪 **再チェック**
6. ✨ **本運用開始**

---

**作成者**: Worker3 (Claude Code)
**相談先**:
- Worker2（テスト観点）
- GPT-5（改善案）

